import pandas as pd
import os

def log_to_csv(file_path, out_path):
    df = pd.read_csv(file_path, comment="#", sep='\t', engine='python')

    df.columns = ['ts', 'uid', 'id.orig_h', 'id.orig_p', 'id.resp_h', 'id.resp_p', 'proto', 
              'service', 'duration', 'orig_bytes', 'resp_bytes', 'conn_state', 
              'local_orig', 'local_resp', 'missed_bytes', 'history', 'orig_pkts', 
              'orig_ip_bytes', 'resp_pkts', 'resp_ip_bytes', 'label']
    
    # get the name of the file
    filename = os.path.basename(file_path)
    # remove the extension
    filename = filename.replace(".labeled", "")

    # write to csv
    df.to_csv(out_path, index=False)

    print(f"{filename} saved to csv")

    pass

